!function(t){var e={};function a(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=e,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)a.d(r,s,function(e){return t[e]}.bind(null,s));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=3)}([function(t,e,a){"use strict";e.a={void:-1,blank:0,black:1,white:2,ban:3,ko:4}},function(t,e,a){"use strict";var r=a(0);const s=1.732,i=s,n=s/2;var h=class{constructor(t,e,a,r=!0,s="white"){this.x=t,this.y=e,this.r=a,this.up=r,this.color=s,this.creatShape()}creatShape(){this.x1=this.x,this.y1=this.y,this.x2=this.x+this.r*s,this.y2=this.y,this.x3=this.x+this.r*n,this.y3=this.y+1.5*this.r,this.up&&(this.y3=this.y,this.y2=this.y+1.5*this.r,this.y1=this.y+1.5*this.r)}draw(t){t.beginPath(),t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2),t.lineTo(this.x3,this.y3),t.fillStyle=this.color,t.closePath(),t.fill(),t.strokeStyle="black",t.stroke()}mouseCheck(t,e){if(t<this.x1||t>this.x2)return!1;if(this.up){if(e<this.y3||e>this.y1)return!1}else if(e>this.y3||e<this.y1)return!1;if(this.up){if(t<this.x3){if(e<(t-this.x3)*-i+this.y3)return!1}else if(e<(t-this.x3)*i+this.y3)return!1}else if(t<this.x3){if(e>(t-this.x1)*i+this.y1)return!1}else if(e>(t-this.x3)*-i+this.y3)return!1;return!0}};const o={normal:{onStart:t=>{let e="gray";switch(t.data){case r.a.black:e="black";break;case r.a.white:e="white";break;case r.a.blank:e="gray";break;case r.a.ban:e="pink";break;case r.a.ko:e="green";break;default:e="blue"}t.setColor(e)},update:t=>{o.normal.onStart(t)},handleInput:(t,e,a,s)=>{s.data===r.a.blank&&s.triangle.mouseCheck(t,e)&&(a?s.changeState(o.keydown):s.changeState(o.hover))}},hover:{onStart:t=>{t.setColor("yellow")},handleInput:(t,e,a,r)=>{a?r.changeState(o.keydown):r.triangle.mouseCheck(t,e)||r.changeState(o.normal)}},keydown:{onStart:t=>{t.setColor("red")},handleInput:(t,e,a,r)=>{r.triangle.mouseCheck(t,e)||r.changeState(o.normal),a||(r.onactive(r),r.changeState(o.normal))}}};var c=class{constructor(t,e,a,s,i,n){this.triangle=new h(t,e,a,s),this.coordinate=i,this.data=r.a.blank,this.state=o.normal,this.state.onStart(this),this.onactive=n}setData(t){this.data=t}setColor(t){this.triangle.color=t}changeState(t){this.state=t,this.state.onStart(this)}render(t){return this.triangle.draw&&this.triangle.draw(t)}handleInput(t,e,a){return this.state.handleInput&&this.state.handleInput(t,e,a,this)}update(){return this.state.update&&this.state.update(this)}};a.d(e,"a",function(){return b}),a.d(e,"b",function(){return y});const l=.866;class u{constructor(t){this.data=[],this.current=-1,this.push(t)}push(t){this.data.length=this.current+1,this.data.push({black:t.black,white:t.white,ban:t.ban,ko:t.ko,cclr:t.currentColor}),this.current+=1}undo(t){if(this.current-=1,-1===this.current)return this.current=0,!1;const e=this.data[this.current];return t.black=e.black,t.white=e.white,t.ko=e.ko,t.ban=e.ban,t.currentColor=e.cclr,!0}redo(t){if(this.current+=1,this.current===this.data.length)return this.current=this.data.length-1,!1;const e=this.data[this.current];return t.black=e.black,t.white=e.white,t.ko=e.ko,t.ban=e.ban,t.currentColor=e.cclr,!0}contain(t,e,a){for(let r=this.current;r>-1;r-=1){const s=this.data[r];if(s.black===t&&s.white===e&&s.cclr===a)return!0}return!1}clear(){this.data.length=1,this.current=0}}class d{constructor(){this.data=[]}static index2xy(t){return{x:7&t,y:t>>>3}}static xy2index(t,e){let a=e<<3;return a|=7&t}push(t,e){this.data.push(d.xy2index(t,e))}indexof(t,e){const a=d.xy2index(t,e);return this.data.indexOf(a)}clear(){this.data.length=0}forEach(t){for(let e=0;e<this.data.length;e+=1){const a=this.data[e],{x:r,y:s}=d.index2xy(a);t(r,s)}}}function k(t){switch(t){case r.a.black:return r.a.white;case r.a.white:return r.a.black;default:return r.a.void}}class b{constructor(t){this.black=0,this.white=0,this.ban=0,this.ko=0,this.currentColor=r.a.black,t&&(this.black=t.black,this.white=t.white,this.ban=t.ban,this.ko=t.ko,this.currentColor=t.currentColor),this.history=new u(this),this.adjacencylist=[];for(let t=0;t<8;t+=1)this.adjacencylist.push([]);for(let t=0;t<4;t+=1)for(let e=0;e<8;e+=1){this.adjacencylist[e][t]=[];const a=e-1,r=e+1,s=1&e?e-1:e+1,i=1&e?t+1:t-1;a>-1&&this.adjacencylist[e][t].push({x:a,y:t}),r<8&&this.adjacencylist[e][t].push({x:r,y:t}),s<8&&s>-1&&i<4&&i>-1&&this.adjacencylist[e][t].push({x:s,y:i})}}swapColor(){this.currentColor=k(this.currentColor)}save(){this.history.push(this)}undo(){return this.history.undo(this)}redo(){return this.history.redo(this)}setCurrentColor(t){this.currentColor=t}getScore(){let t=0,e=0,a=this.black;for(;a;)a&=a-1,t+=1;for(a=this.white;a;)a&=a-1,e+=1;return{black:t,white:e}}getData(t,e){if(t<0||t>7||e<0||e>3)return r.a.void;const a=1<<(t|e<<3);return this.black&a?r.a.black:this.white&a?r.a.white:this.ban&a?r.a.ban:this.ko&a?r.a.ko:r.a.blank}setData(t,e,a){if(t<0||t>7||e<0||e>3)return;const s=1<<(t|e<<3);switch(this.black&=~s,this.white&=~s,this.ban&=~s,this.ko&=~s,a){case r.a.black:this.black|=s;break;case r.a.white:this.white|=s;break;case r.a.ban:this.ban|=s;break;case r.a.ko:this.ko|=s}}isGameEnd(){return-1==(this.black|this.white|this.ban|this.ko)}updateBanAndKo(t){this.ban=0,this.ko=0;const e=[];for(let t=0;t<4;t+=1)for(let a=0;a<8;a+=1)if(this.getData(a,t)===r.a.blank){const s=this.adjacencylist[a][t];s.reduce((t,e)=>{return t+(this.getData(e.x,e.y)===r.a.blank?0:1)},0)===s.length&&e.push({x:a,y:t})}const a=this.black,s=this.white;e.forEach(e=>{const{x:i,y:n}=e;this.setData(i,n,t),this.updateBlackAndWhite(i,n),this.getData(i,n)===r.a.blank?this.setData(i,n,r.a.ban):this.history.contain(this.black,this.white,k(t))&&this.setData(i,n,r.a.ko),this.black=a,this.white=s})}updateBlackAndWhite(t,e){const a=new d,s=this.adjacencylist[t][e],i=[],n=(t,e,s)=>{if(a.indexof(t,e)>-1)return!1;const i=this.getData(t,e);return i===r.a.blank||i===r.a.ko||i===r.a.ban||i===s&&(a.push(t,e),this.adjacencylist[t][e].reduce((t,e)=>t||n(e.x,e.y,s),!1))};let h,o=!1;const c=this.getData(t,e);s.forEach(t=>{if(-1!==a.indexof(t.x,t.y))return;const e=t.x,s=t.y,l=this.getData(e,s);l===k(c)?(a.clear(),(h=n(e,s,l))||(o=!0,a.forEach((t,e)=>{i.push({x:t,y:e})}))):l===r.a.blank&&(o=!0)}),o||(a.clear(),(h=n(t,e,c))||a.forEach((t,e)=>{i.push({x:t,y:e})})),i.forEach(t=>{this.setData(t.x,t.y,r.a.blank)}),a.clear()}clear(){this.black=0,this.white=0,this.ban=0,this.ko=0,this.currentColor=r.a.black,this.history.clear()}}class f{constructor(t){this.triCheckers=[];let e=!0;const a=1/l;for(let r=0;r<4;r+=1)for(let s=0;s<8;s+=1){const i=new c(90+s*(60*l+a)+r*(60*l+1),520-91*(1+r),60,e,{x:s,y:r},t);this.triCheckers.push(i),e=!e}}update(){this.triCheckers.forEach(t=>{t.update()})}render(t){this.triCheckers.forEach(e=>{e.render(t)})}}class y{constructor(){this.data=new b,this.view=new f(t=>{const{x:e,y:a}=t.coordinate;return this.placePiece(e,a,this.getCurrentColor()),this.getCurrentColor()}),this.updateAllCheckers()}save(){this.data.save()}setCurrentColor(t){this.data.setCurrentColor(t)}undo(){return!!this.data.undo()&&(this.updateBanAndKo(this.getCurrentColor()),this.updateAllCheckers(),!0)}redo(){return!!this.data.redo()&&(this.updateBanAndKo(this.getCurrentColor()),this.updateAllCheckers(),!0)}getScore(){return this.data.getScore()}getData(t,e){return this.data.getData(t,e)}setData(t,e,a){this.data.setData(t,e,a)}placePiece(t,e,a){this.setData(t,e,a),this.updateBlackAndWhite(t,e)}isGameEnd(){return this.data.isGameEnd()}updateBanAndKo(t){this.data.updateBanAndKo(t)}updateBlackAndWhite(t,e){this.data.updateBlackAndWhite(t,e)}updateAllCheckers(){this.view.triCheckers.forEach(t=>{const e=this.getData(t.coordinate.x,t.coordinate.y);t.setData(e)})}update(){this.view.update()}render(t){this.view.render(t)}getCurrentColor(){return this.data.currentColor}handleInput(t,e,a,r,s){const i=this.data.black,n=this.data.white;return this.view.triCheckers.forEach(r=>r.handleInput(t,e,a)),(i!==this.data.black||n!==this.data.white)&&(r&&r(),this.updateBanAndKo(this.getCurrentColor()),this.updateAllCheckers(),this.save(),this.isGameEnd()&&s&&s(),!0)}clear(){this.data.clear(),this.updateAllCheckers()}}y.instance=new y},,function(t,e,a){"use strict";a.r(e);var r=a(0),s=a(1);const i={x:0,y:0};let n=5;function h(t,e,a,s){if(t.isGameEnd()){const{black:e,white:a}=t.getScore();return 100*(t.currentColor===r.a.black?e-a:a-e)}if(e<1){const{black:e,white:a}=function(t){let e=0,a=0,s=0,i=0;for(let n=0;n<4;n+=1)for(let h=0;h<8;h+=1){const o=t.getData(h,n);if(o===r.a.black)e+=1;else if(o===r.a.white)a+=1;else if(o!==r.a.void){const o=t.adjacencylist[h][n],c=o.reduce((e,a)=>{const s=t.getData(a.x,a.y);return e+(s===r.a.black?1:s===r.a.white?-1:0)},0);c===o.length?(e+=1,s+=1):c===-o.length&&(a+=1.2,i+=1)}}return s>1&&(e+=6),i>1&&(a+=10),{black:e,white:a}}(t);return t.currentColor===r.a.black?e-a:a-e}const o={black:t.black,white:t.white,ban:t.ban,ko:t.ko,currentColor:t.currentColor},c=function(t){const e=[];for(let a=0;a<4;a+=1)for(let s=0;s<8;s+=1)if(t.getData(s,a)===r.a.blank){let i=0;t.adjacencylist[s][a].forEach(e=>{const a=t.getData(e.x,e.y);a!==r.a.black&&a!==r.a.white||(i+=1),t.adjacencylist[e.x][e.y].forEach(e=>{const a=t.getData(e.x,e.y);a!==r.a.black&&a!==r.a.white||(i+=1)})}),e.push({x:s,y:a,score:i})}return e.sort((t,e)=>e.score-t.score+Math.random()-.5),e.length>6&&(e.length=6),e}(t);for(let l=0;l<c.length;l+=1){const{x:u,y:d}=c[l];if(t.getData(u,d)!==r.a.blank)continue;t.setData(u,d,t.currentColor),t.updateBlackAndWhite(u,d),t.swapColor(),t.updateBanAndKo(t.currentColor);const k=-h(t,e-1,-s,-a);if(t.black=o.black,t.white=o.white,t.ban=o.ban,t.ko=o.ko,t.currentColor=o.currentColor,k>a&&(a=k,e===n&&(i.x=u,i.y=d)),k>=s)break}return a}var o=function(t){const e=new s.a(t),a=e.getScore(),r=32-a.black-a.white;return h(e,n=r>30?4:r>24?5:r>12?6:r>8?7:8,-1e6,1e6),i};onmessage=(t=>{postMessage(o(t.data))});e.default=void 0}]);